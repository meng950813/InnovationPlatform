<!doctype html>
<html>
<head>
    <!-- create by cm -->
    <meta charset="utf-8"> 
    <link href="__PUBLIC__/css/home/index.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="__PUBLIC__/css/home/nav.css">
    <title>张家港工程项目协同创新服务平台</title>
    
    <!-- [if IE lt 10] -->
        <style>
            div,a,img{
                border: none;
            }
            .control{
                position: absolute;
                left: 50%;
                margin-left: -65px;
                top: 270px;
            }
            .control-btn{
                float: left;
                width: 13px;
                height: 13px;
                margin-left: 13px;
                border: 1px solid transparent;
                background: white;
            }
            .focus{
                background: blue;
            }
            .login_show{
                display: block;
            }
            .login_hidden{
                display: none;
            }
            #login_btns>button,#signup-btn{
                background: #5dc3fe;
            }
        </style>
    <!-- [endif] -->
</head>

<body>
    <include file = "Public/nav"/>
    <div id="banner-show">
        <div id="banner-container">
            <ul>
                <li index="0"><img src="__PUBLIC__/images/banner_300_1.png" alt=""></li>
                <li index="1"><img src="__PUBLIC__/images/banner_300_2.png" alt=""></li>
                <li index="2"><img src="__PUBLIC__/images/banner_300_3.png" alt=""></li>
            </ul>
        </div>
        <div class="control">
            <div class="control-btn focus"></div>
            <div class="control-btn"></div>
            <div class="control-btn"></div>
        </div>
    </div>
    <div id="index_main_container">
        <!-- 新闻部分 -->
        <div class="news_part">
            <p><span>新闻中心</span><a href="{:U('News/newslist')}">更多&gt;&gt;</a></p>
            <div class="picture_and_title">
                <volist id="newsPicture" name="newsPicture">
                    <div class="news_picture">
                        <span>
                            <a href="{:U('News/news',array('id'=>$newsPicture['news_id']))}"><img src="__ROOT__/{$newsPicture.picture}"></a>
                        </span>
                    
                        <div class="news_title">
                            <a href="{:U('News/news',array('id'=>$newsPicture['news_id']))}" >{$newsPicture.title}</a>
                        </div>
                    </div>
                </volist>
            </div>
            <ul>
                <volist id="newsInfo" name="newsInfo">
                    <li><a href="{:U('News/news',array('id'=>$newsInfo['news_id']))}" title="{$newsInfo.title}">{$newsInfo.title}</a></li>
                </volist>
            </ul>
        </div>
        <!-- 四图文 -->
        <ul class="index_four_part">
            <li>
                <h2>科技成果</h2>
                <ul class="four_part_tip">
                    <volist id="resultInfo" name="resultInfo">
                         <li><a href="{:U('Result/result',array('id'=>$resultInfo['result_id']))}" title="{$resultInfo.result_name}">{$resultInfo.result_name}</a></li>
                    </volist>
                </ul>
            </li>
            <li>
                <h2>企业需求</h2>
                <ul class="four_part_tip">
                   <volist id="demandInfo" name="demandInfo">
                        <li><a href="{:U('Demand/demand',array('id'=>$demandInfo['demand_id'],'com'=>$demandInfo['demand_com']))}" title="{$demandInfo.title}">{$demandInfo.title}</a></li>
                    </volist>
                </ul>
            </li>
        </ul>
        <ul class="index_four_part">
            <li>
                <h2>协同管理</h2>
                <ul class="four_part_tip">
                   <volist id="cooInfo" name="cooInfo">
                        <li><a href="http://{$cooInfo.website}" title="{$cooInfo.name}">{$cooInfo.name}</a></li>
                    </volist>
                </ul>
            </li>
            <li>
                <h2>下载中心</h2>
                <ul class="four_part_tip">
                   <volist id="downloadInfo" name="downloadInfo">
                        <li><a href="{:U('Download/filelist',array('id'=>$downloadInfo['file_id']))}">{$downloadInfo.download_title}</a></li>
                    </volist>
                </ul>
            </li>
        </ul>
          <!-- 典型案例 -->
        <div class="news_part">
            <p><span>典型案例</span><a href="{:U('ClassicCase/caselist')}">更多&gt;&gt;</a></p>
            <div class="picture_and_title">
                <volist id="casePicture" name="casePicture">
                    <div class="case_picture">
                        <span>
                            <a href="{:U('ClassicCase/cases',array('id'=>$casePicture['case_id']))}"><img src="__ROOT__/{$casePicture.picture}"></a>
                        </span>
                    
                        <div class="case_title">
                            <a href="{:U('ClassicCase/cases',array('id'=>$casePicture['case_id']))}">{$casePicture.case_title}</a>
                        </div>
                    </div>
                </volist>
            </div>
            <ul>
                <volist id="caseInfo" name="caseInfo">
                    <li><a href="{:U('ClassicCase/cases',array('id'=>$caseInfo['case_id']))}" title="{$caseInfo.case_title}">{$caseInfo.case_title}</a></li>
                </volist>
            </ul>
        </div>
    </div>

    <include file = "Public/footer" />
    <script src="__PUBLIC__/js/jquery.min.js"></script>
    <script>
        $(function(){

            $('#nav_index').addClass('nav_active').siblings().removeClass('nav_active');
           
            function nextImg () {
                var container = $('#banner-container');
                var moveWidth = ($("#banner-container li").width())*-1;
                container.stop().animate({left:moveWidth},'slow',function(){
                    var firstImg = $('#banner-container ul li').first();
                    container.find("ul").append(firstImg);
                    $(this).css('left',"0px");
                });
                 btnCircle();
            }
            function btnCircle(){
                var btnNum = $('#banner-container ul li').first().attr("index");
                $(".control .control-btn").siblings().removeClass("focus");
                $(".control .control-btn").eq((btnNum+1)%3).addClass("focus");
            }
            setInterval(nextImg,5000);

            var animateEnd = 1;
            $('.control-btn').click(function(){
                if(animateEnd == 1){ // 表示图片不在切换
                    $(this).addClass('focus').siblings().removeClass('focus');
                    var nextIndex = $(this).index();
                    // console.log("nextIndex = "+nextIndex);
                    // 获取当前显示图片序列
                    var currentIndex = $('#banner-container li').first().attr('index');
                    // 保存当前图片
                    var curr = $("#banner-container li").first().clone();
                    if(currentIndex < nextIndex){
                        for(var i=0; i<nextIndex-currentIndex;i++){
                            var firstImg = $('#banner-container li').first();
                            // 将目标图片之前的图片加到后面
                            $('#banner-container ul').append(firstImg);
                        }
                        // 结束循环，当前效果
                        // console.log("结束循环 ："+animateEnd);
                        $("#banner-container ul").prepend(curr);
                        var moveWidth = ($('#banner-container li').width())*-1;
                        if(animateEnd == 1){    
                            animateEnd = 0;//表示开始切换，期间不允许再次切换
                            $('#banner-container').stop().animate({left:moveWidth},"slow",function(){
                                $("#banner-container ul li").first().remove();
                                $("#banner-container").css("left","0px");
                                animateEnd = 1;
                            });
                        }
                    }
                    else{
                        // 保存最后一张图片
                        var curt = $("#banner-container li").last().clone();
                        for(var i = 0; i < currentIndex - nextIndex;i++){
                            var lastItem = $("#banner-container li").last();
                            $("#banner-container ul").prepend(lastItem);
                        }
                        $("#banner-container ul").append(curt);
                        var moveWidth = ($("#banner-container li").width())*-1;
                        $("#banner-container").css("left",moveWidth);
                        if(animateEnd = 1){
                            $("#banner-container ul li").last().remove();
                            animateEnd = 0;
                            $("#banner-container").stop().animate({left:"0px"},"slow",function(){
                                animateEnd = 1;
                            });
                        }
                    }
                }
            });
        });
        $(function(){
            $(".news_picture").hide().first().fadeIn();
            var y=0
            var z=setInterval(function(){
                if(++y==5){y=0;}
                $(".news_picture").eq(y).fadeIn().siblings().fadeOut();
            },5000);

            $(".case_picture").hide().first().fadeIn();
            var y=0
            var z=setInterval(function(){
                if(++y==5){y=0;}
                $(".case_picture").eq(y).fadeIn().siblings().fadeOut();
            },5000);
        });
		(function(){
            var bodyHeight = document.body.innerHeight;
            var contentHeight = document.getElementById('index_main_container').innerHeight;
            // 已知：top:80px ,nav:50px,banner:300px;bottombox:60px
            if((bodyHeight-430-contentHeight)>60){
                bottombox.className="buttom_fixed";
            }
        })();
    </script>
</body>
</html>
